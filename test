#!/usr/bin/env python
"""Test script for orchestrator module."""

import sys
sys.path.insert(0, '.')

# Test imports
print('Testing imports...')
from music_engine.orchestrator import (
    Coordinator, InputController, OutputFormatter,
    ScaleSolver, ChordSolver, ConflictResolver,
    ProgressionExpander, ContinuationGenerator, SubstitutionHandler,
    GenreDetector, JazzRules, PopRules, RockRules, BluesRules
)
print('OK: All imports successful')

# Test basic functionality
print('\nTesting basic functionality...')

# Test InputController
controller = InputController()
result = controller.parse_input('Cmaj7')
print('OK: Parsed chord:', result["name"])

result = controller.parse_input('C major')
print('OK: Parsed scale:', result["name"])

result = controller.parse_input('C G Am F')
print('OK: Parsed progression:', result["chords"])

# Test GenreDetector
detector = GenreDetector()
genre = detector.detect_from_input('Cmaj7 Dm7 G7 Cmaj7')
print('OK: Detected genre:', genre)

# Test genre rules
jazz = JazzRules()
print('OK: Jazz preferred scales:', jazz.preferred_scales[:3])

# Test Coordinator
coordinator = Coordinator()
result = coordinator.process('Cmaj7', {'genre': 'jazz'})
print('OK: Coordinator processed chord:', result.get("chord", {}).get("name"))

print('\n=== ALL TESTS PASSED ===')
